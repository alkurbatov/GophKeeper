# Рабочий процесс

## Глоссарий
* Ключ шифрования - используется для шифрования и дешифрования данных.
* Ключ безопасности - хэш сумма ключа шифрования.

## Генерация ключа шифрования
Ключ шифрования представляет собой строку, содержащей логин и пароль пользователя. Ключ шифрования не хранится на стороне сервера и не известен ему.

## Алгоритм регистрации пользователя
1. Клиент генерирует локально ключ шифрования.
2. Клиент генерирует хэш сумму с помощью алгоритма `sha256` с дополнительным кодированием в `hex` для удобства.
3. Клиент передает имя пользователя и ключ безопасности серверу.
4. Сервер генерирует из полученного ключа безопасности хэш с солью средствами БД `postgres` и сохраняет его в базе данных пользователей.
5. В случае успеха сервер создает `JWT` токен, используемый в дальнейшем для аутентификации клиента. Токен подписан методом `HS256` и в текущей реализации может быть провалидирован только на стороне сервера.

## Алгоритм логина пользователя
1. Клиент генерирует локально ключ шифрования.
2. Клиент генерирует хэш сумму с помощью алгоритма `sha256` с дополнительным кодированием в `hex` для удобства.
3. Клиент передает имя пользователя и ключ безопасности серверу.
4. Сервер генерирует из полученного ключа безопасности хэш с солью средствами БД `postgres` и проверяет на совпадение с хэшом сохраненым в базе данных пользователей.
5. В случае успеха сервер создает `JWT` токен, используемый в дальнейшем для аутентификации клиента. 

## Дополнительная информация
* [Bitwarden: Аутентификация](https://bitwarden.com/blog/bitwarden-security-fundamentals-and-multifactor-encryption)
* [Bitwarden: Шифрование](https://bitwarden.com/help/what-encryption-is-used)
